import{d as z,r as $,o as r,c as v,b as p,ab as y,a6 as d,R as n,aj as E,a as t,X as C,m as x,b3 as D,b4 as P,b5 as J,l as K,a2 as X,$ as Y,O as g,a4 as M,b6 as H,N as F,a5 as S,b7 as A,aW as Z,b8 as Q,ah as k,a9 as R,a1 as h,b9 as ee,Q as U,ac as te,a3 as T,ba as ae,aa as se,a8 as le,bb as q,bc as oe}from"./index-3af22ecb.js";import{N as W,a as G}from"./Switch-056d63a8.js";const ne={key:0,class:"cursor-pointer"},ie=z({__name:"mcUploadMp3",setup(N){const o=$(),l=$({process:"",id:"",isUpload:!1}),c=async m=>{for(let f=0;f<50;f++){let _=await D(`/uploads/audio/${m}`);x("ddd",_);let w=f+1;if(w>20&&(w=20),_.status=="complete"||_.status=="error")return _;await J(w*1e3)}return null};async function a(m){try{l.value.isUpload=!0,x("uploadFile",m.target.files[0]);const f=await D("/uploads/audio",{extension:"mp3"});x("init ",f),l.value.id=f.id;const _=new FormData;for(let e in f.fields)_.append(e,f.fields[e]);if(_.append("file",m.target.files[0]),!(await fetch(f.url,{method:"POST",body:_})).ok)throw new Error("Network response was not ok");x("uploaded ");const j=await D("/uploads/audio/"+f.id+"/upload-finish",{upload_type:"file_upload",upload_filename:m.target.files[0].name});x("finish ",j);const i=await c(f.id);x("uploadFetch ",i);const s=await D("/uploads/audio/"+f.id+"/initialize-clip",{});x("clip ",s),P([s.clip_id])}catch{}l.value.isUpload=!1,o.value.value=""}return(m,f)=>(r(),v(C,null,[p(n(E),{type:"success",size:"small",round:""},{default:y(()=>[l.value.isUpload?(r(),v("span",ne,"Upload...")):(r(),v("span",{key:1,class:"cursor-pointer",onClick:f[0]||(f[0]=_=>o.value.click())},d(m.$t("suno.upMps")),1))]),_:1}),t("input",{type:"file",onChange:a,ref_key:"fsRef",ref:o,style:{display:"none"},accept:".mp3"},null,544)],64))}}),ue={class:"p-2"},de={class:"pt-1"},re={class:"pt-4 flex justify-between"},pe={class:"pt-1"},ce={class:"pt-1"},ve={class:"pt-1"},me={class:"pt-4"},fe={class:"pt-4 flex justify-between"},_e={class:"pt-1"},ye={class:"pt-1"},xe={class:"pt-5"},he={class:"flex justify-between pb-3"},ge={class:"text-[12px]"},be={class:"bg-[--n-fill-color] text-[9px] border-[0px] px-1 list-none rounded-md"},$e={class:"pt-1"},ke={class:"flex relative justify-between items-start p-2 hover:dark:bg-black hover:bg-gray-200 border-b-[1px] border-gray-500/10"},we={class:"w-[60px] h-[60px] relative cursor-pointer"},De={class:"w-full h-full justify-center items-center flex"},je={class:"flex-1 pl-2"},Ce={class:"flex justify-between line-clamp-1 w-full cursor-pointer"},Ue={key:0,class:"opacity-60 line-clamp-1 w-full text-[12px] cursor-pointer"},ze={key:1,class:"opacity-60 line-clamp-1 w-full text-[12px] cursor-pointer"},Ne={class:"text-right text-[14px] flex justify-end items-center space-x-2"},Le={key:0,class:"text-[8px] flex items-center border-[1px] border-red-500/80 px-1 list-none rounded-md"},Fe={key:1,class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md"},Se={key:2,class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md"},Me={class:"pt-4"},Te={class:"flex justify-between items-start"},Re={class:"space-x-1"},Ee=["innerHTML"],Pe=z({__name:"mcInput",setup(N){const o=$({type:"custom",isLoading:!1}),l=$(),c=$({gpt_description_prompt:"",make_instrumental:!1,mv:"chirp-v3-5",prompt:""}),a=$({prompt:"",mv:"chirp-v3-5",title:"",tags:"",continue_at:120,continue_clip_id:""}),m=[{label:"verion: v3.5",value:"chirp-v3-5"},{label:"verion: v3",value:"chirp-v3-0"}],f=K(()=>o.value.isLoading?!1:o.value.type=="custom"?a.value.tags&&a.value.title:o.value.type=="description"?(x("des: ",c.value.gpt_description_prompt,c.value.make_instrumental),a.value.title&&(c.value.gpt_description_prompt||c.value.make_instrumental)):!0),_=X();Y(()=>{g.setMyData({ms:_})});const w=()=>{let i=a.value.prompt||a.value.title;if(!i){_.error(T("suno.inputly"));return}if(o.value.isLoading){_.info(T("suno.doingly"));return}o.value.isLoading=!0,_.info(T("suno.doingly2")),D("/generate/lyrics/",{prompt:i}).then(async s=>{x("lyrics",s);let e=await ae(s.id);x("lyrics rz =>",e),e!=null&&(a.value.prompt=e.text,a.value.title=e.title),o.value.isLoading=!1}).catch(()=>o.value.isLoading=!1),a.value.tags||(a.value.tags=Q())},j=async()=>{var s,e;o.value.isLoading=!1;let i=["0d435185-d440-42c8-982a-50205e1cf17d","43e095ba-5f08-4920-bb3d-89dd0defe0b7"];if(i=["d359a0aa-adf1-4298-9074-005573d7cc84","12e3d62f-8fcc-497b-8365-194657582519"],o.value.type=="custom"){c.value.make_instrumental&&(a.value.prompt=""),a.value.continue_clip_id!=""&&((e=(s=l.value)==null?void 0:s.metadata)==null?void 0:e.type)=="upload"&&(a.value.mv="chirp-v3-5-upload");let b=await D("/generate",a.value);o.value.isLoading=!1,i=b.clips.map(u=>u.id),x("ids ",i),(a.value.mv="chirp-v3-5-upload")&&(a.value.mv="chirp-v3-5")}else{c.value.prompt=a.value.title;let b=await D("/generate/description-mode",c.value);o.value.isLoading=!1,i=b.clips.map(u=>u.id)}P(i)};return M(()=>g.myData.act,i=>{if(i=="suno.extend"){x("suno.extend",g.myData.actData);const s=g.myData.actData;l.value=s,a.value.continue_clip_id=s.id,a.value.continue_at=Math.ceil(s.metadata.duration/2)}}),(i,s)=>(r(),v("div",ue,[p(n(ee),{type:"segment",animated:"",value:o.value.type,"onUpdate:value":s[12]||(s[12]=e=>o.value.type=e)},{default:y(()=>[p(n(H),{name:"description",tab:i.$t("suno.description")},{default:y(()=>[t("div",de,[p(n(F),{placeholder:i.$t("suno.titlepls"),value:a.value.title,"onUpdate:value":s[0]||(s[0]=e=>a.value.title=e)},{prefix:y(()=>[t("span",null,d(i.$t("suno.title"))+"：",1)]),_:1},8,["placeholder","value"])]),t("div",re,[t("div",null,d(i.$t("suno.desc"))+":",1),t("div",null,[p(n(W),{value:c.value.make_instrumental,"onUpdate:value":s[1]||(s[1]=e=>c.value.make_instrumental=e),size:"small"},{checked:y(()=>[S(d(i.$t("suno.noneedly")),1)]),unchecked:y(()=>[S(d(i.$t("suno.noneedly")),1)]),_:1},8,["value"])])]),t("div",pe,[p(n(F),{value:c.value.gpt_description_prompt,"onUpdate:value":s[2]||(s[2]=e=>c.value.gpt_description_prompt=e),disabled:c.value.make_instrumental,placeholder:i.$t("suno.descpls"),type:"textarea",size:"small",autosize:{minRows:3,maxRows:12}},null,8,["value","disabled","placeholder"])]),t("div",ce,[p(n(A),{value:c.value.mv,"onUpdate:value":s[3]||(s[3]=e=>c.value.mv=e),options:m,size:"small"},null,8,["value"])])]),_:1},8,["tab"]),p(n(H),{name:"custom",tab:i.$t("suno.custom")},{default:y(()=>[t("div",ve,[p(n(F),{placeholder:i.$t("suno.titlepls"),value:a.value.title,"onUpdate:value":s[4]||(s[4]=e=>a.value.title=e)},{prefix:y(()=>[t("span",null,d(i.$t("suno.title"))+"：",1)]),_:1},8,["placeholder","value"])]),t("div",me,[p(n(F),{placeholder:i.$t("suno.stylepls"),value:a.value.tags,"onUpdate:value":s[6]||(s[6]=e=>a.value.tags=e)},{prefix:y(()=>[t("span",null,d(i.$t("suno.style"))+"：",1)]),suffix:y(()=>[p(n(Z),{placement:"right",trigger:"hover"},{trigger:y(()=>[t("div",{class:"cursor-pointer",onClick:s[5]||(s[5]=e=>a.value.tags=n(Q)())},[p(n(k),{icon:"fa:random",class:"w-4 h-4"})])]),default:y(()=>[t("div",null,d(i.$t("suno.rank")),1)]),_:1})]),_:1},8,["placeholder","value"])]),t("div",fe,[t("div",null,d(i.$t("suno.ly"))+" :",1),t("div",null,[p(n(W),{value:c.value.make_instrumental,"onUpdate:value":s[7]||(s[7]=e=>c.value.make_instrumental=e),size:"small"},{checked:y(()=>[S(d(i.$t("suno.noneedly")),1)]),unchecked:y(()=>[S(d(i.$t("suno.noneedly")),1)]),_:1},8,["value"])])]),t("div",_e,[p(n(F),{value:a.value.prompt,"onUpdate:value":s[8]||(s[8]=e=>a.value.prompt=e),disabled:c.value.make_instrumental,placeholder:i.$t("suno.lypls"),type:"textarea",size:"small",autosize:{minRows:3,maxRows:12}},null,8,["value","disabled","placeholder"])]),t("div",ye,[p(n(A),{value:a.value.mv,"onUpdate:value":s[9]||(s[9]=e=>a.value.mv=e),options:m,size:"small"},null,8,["value"])]),a.value.continue_clip_id&&l.value?(r(),v(C,{key:0},[t("div",xe,[t("div",he,[t("div",ge,d(i.$t("suno.extendAt"))+" "+d(a.value.continue_at)+"s",1),p(n(E),{type:"success",size:"small",round:""},{default:y(()=>[t("span",{class:"cursor-pointer",onClick:s[10]||(s[10]=e=>a.value.continue_clip_id="")},"清除")]),_:1})]),p(n(G),{value:a.value.continue_at,"onUpdate:value":s[11]||(s[11]=e=>a.value.continue_at=e),step:1,max:Math.ceil(l.value.metadata.duration)},{thumb:y(()=>[t("div",be,d(a.value.continue_at)+"s",1)]),_:1},8,["value","max"])]),t("div",$e,[t("div",ke,[t("div",we,[p(n(R),{lazy:"",width:"100",src:l.value.image_url,"preview-disabled":""},{placeholder:y(()=>[t("div",De,[p(n(k),{icon:"line-md:downloading-loop",class:"text-[40px] text-green-300"})])]),_:1},8,["src"])]),t("div",je,[t("div",Ce,[t("h3",null,d(l.value.title),1)]),l.value.metadata&&l.value.metadata.prompt?(r(),v("div",Ue,d(l.value.metadata.prompt),1)):(r(),v("div",ze,d(i.$t("suno.noly")),1)),t("div",Ne,[l.value.status=="error"?(r(),v("div",Le,"失败")):h("",!0),l.value.metadata&&l.value.metadata.duration?(r(),v("div",Fe,d(l.value.metadata.duration.toFixed(1))+"s",1)):h("",!0),l.value.major_model_version?(r(),v("div",Se,d(l.value.major_model_version),1)):h("",!0)])])])])],64)):h("",!0)]),_:1},8,["tab"])]),_:1},8,["value"]),t("div",Me,[t("div",Te,[t("div",Re,[o.value.type=="custom"?(r(),U(n(E),{key:0,type:"success",size:"small",round:""},{default:y(()=>[t("span",{class:"cursor-pointer",onClick:s[13]||(s[13]=e=>w())},d(i.$t("suno.generately")),1)]),_:1})):h("",!0),o.value.type=="custom"?(r(),U(ie,{key:1})):h("",!0)]),p(n(te),{type:"primary",disabled:!n(f),onClick:s[14]||(s[14]=e=>j())},{default:y(()=>[p(n(k),{icon:"ri:music-fill"}),S(" "+d(i.$t("suno.generate")),1)]),_:1},8,["disabled"])])]),o.value.type=="custom"?(r(),v("div",{key:0,class:"pt-4 text-[12px]",innerHTML:n(T)("suno.info")},null,8,Ee)):h("",!0)]))}}),Be={class:"sss",style:{"--n-rail-height":"2px"}},Ie=z({__name:"playui",emits:["update"],setup(N,{emit:o}){const l=$({v:10,max:0,status:"",idDrop:!1}),c=a=>{g.setMyData({act:"playUpdate",actData:{v:a}})};return M(()=>g.myData.act2,a=>{if(a=="playStatus"){if(l.value.idDrop)return;let m=g.myData.actData;x("playStatus",m),m&&m.d&&m.d.duration&&(l.value.max=m.d.duration,l.value.v=m.d.currentTime),m&&(l.value.status=m.a),o("update",l.value)}}),M(()=>g.myData.act,a=>{if(a=="playStatus"){let m=g.myData.actData;m&&(l.value.status=m.a),o("update",l.value)}}),(a,m)=>(r(),v("div",Be,[l.value.max?(r(),U(n(G),{key:0,"on-dragend":()=>l.value.idDrop=!1,"on-dragstart":()=>l.value.idDrop=!0,class:"w-full",value:l.value.v,"onUpdate:value":m[0]||(m[0]=f=>l.value.v=f),step:1,max:l.value.max,"on-update:value":c,"format-tooltip":f=>f.toFixed(1)+"s"},null,8,["on-dragend","on-dragstart","value","max","format-tooltip"])):h("",!0)]))}});const Oe={key:0},Ve=["onClick"],He={class:"w-full h-full justify-center items-center flex"},Ae={key:0,class:"absolute top-0 right-0 w-full h-full flex justify-center items-center"},Qe={class:"absolute top-0 right-0 w-full h-full justify-center items-center flex"},We={class:"flex-1 pl-2"},Xe=["onClick"],qe={class:"flex justify-start items-center"},Ge={key:0,class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 ml-1 list-none rounded-md"},Je={class:"opacity-80"},Ke=["onClick"],Ye=["onClick"],Ze={class:"text-right text-[14px] flex justify-end items-center space-x-2"},et={key:0,class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md"},tt={key:1,class:"text-[8px] flex items-center border-[1px] border-red-500/80 px-1 list-none rounded-md"},at={class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md"},st=["onClick"],lt={key:3,class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md"},ot=["href"],nt={key:1,class:"w-full h-full flex justify-center items-center"},it=z({__name:"mcList",setup(N){const o=$([]),l=new oe,c=$({playid:""}),a=X(),m=()=>{let e=l.getObjs();o.value=e.reverse()},f=e=>e.id==c.value.playid?["bg-gray-200","dark:bg-black"]:[],_=e=>{if(e.status=="error"){a.info("这首歌生成失败！");return}c.value.playid=e.id,g.setMyData({act:"goPlay",actData:e}),e.status!="complete"&&P([e.id])},w=e=>{x("extend",w),g.setMyData({act:"suno.extend",actData:e})},j=$({v:10,max:0,status:"",idDrop:!1});M(()=>g.myData.act,e=>{if(e=="FeedTask"&&m(),e=="playEned"){let b=o.value.findIndex(u=>u.id==c.value.playid);b++,x("playEned,",b,o.value.length),b<o.value.length&&setTimeout(()=>_(o.value[b]),1e3)}});const i=e=>{e=e.replace("m_","");let b=o.value.findIndex(u=>u.id==e);return b<0?null:o.value[b]},s=e=>{j.value=e};return m(),(e,b)=>o.value.length>0?(r(),v("div",Oe,[(r(!0),v(C,null,se(o.value,u=>{var B,I,O,V;return r(),v("div",{class:le([f(u),"flex relative justify-between items-start p-2 hover:dark:bg-black hover:bg-gray-200 border-b-[1px] border-gray-500/10"])},[c.value.playid==u.id?(r(),U(Ie,{key:0,onUpdate:s,class:"absolute top-[-4px] left-0 w-full z-10"})):h("",!0),t("div",{class:"w-[60px] h-[60px] relative cursor-pointer",onClick:L=>_(u)},[u.status=="complete"?(r(),v(C,{key:0},[p(n(R),{lazy:"",width:"100",src:u.image_url,"preview-disabled":""},{placeholder:y(()=>[t("div",He,[p(n(k),{icon:"line-md:downloading-loop",class:"text-[40px] text-green-300"})])]),_:2},1032,["src"]),c.value.playid==u.id?(r(),v("div",Ae,[j.value.status=="pause"?(r(),U(n(k),{key:0,icon:"mdi:pause-circle-outline",class:"text-[40px] text-[#fff]"})):(r(),U(n(k),{key:1,icon:"mdi:play-circle-outline",class:"text-[40px] text-[#fff]"}))])):h("",!0)],64)):(r(),v(C,{key:1},[p(n(R),{lazy:"",width:"100",src:u.image_url,"preview-disabled":""},null,8,["src"]),t("div",Qe,[p(n(k),{icon:"line-md:downloading-loop",class:"text-[40px] text-green-300"})])],64))],8,Ve),t("div",We,[t("div",{class:"flex justify-between line-clamp-1 w-full cursor-pointer",onClick:L=>_(u)},[t("div",qe,[t("h3",null,d(u.title),1),((B=u.metadata)==null?void 0:B.type)=="upload"?(r(),v("div",Ge,"Uploaded")):h("",!0)]),t("div",Je,d(u.metadata.tags),1)],8,Xe),u.metadata&&u.metadata.prompt?(r(),v("div",{key:0,class:"opacity-60 line-clamp-1 w-full text-[12px] cursor-pointer",onClick:L=>_(u)},d(u.metadata.prompt),9,Ke)):(r(),v("div",{key:1,class:"opacity-60 line-clamp-1 w-full text-[12px] cursor-pointer",onClick:L=>_(u)},d(e.$t("suno.noly")),9,Ye)),t("div",Ze,[(I=u.metadata)!=null&&I.audio_prompt_id?(r(),v("div",et,d(e.$t("suno.extendFrom"))+":"+d((V=i((O=u.metadata)==null?void 0:O.audio_prompt_id))==null?void 0:V.title),1)):h("",!0),u.status=="error"?(r(),v("div",tt,d(e.$t("suno.fail")),1)):h("",!0),u.metadata&&u.metadata.duration?(r(),v(C,{key:2},[t("div",at,d(u.metadata.duration.toFixed(1))+"s",1),t("div",{onClick:L=>w(u),class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md cursor-pointer"},d(e.$t("suno.extend")),9,st)],64)):h("",!0),u.major_model_version?(r(),v("div",lt,d(u.major_model_version),1)):h("",!0),p(n(k),{icon:"mdi:play-circle-outline",class:"cursor-pointer",onClick:L=>_(u)},null,8,["onClick"]),t("a",{href:u.audio_url,download:"",target:"_blank"},[p(n(k),{icon:"mdi:download",class:"cursor-pointer"})],8,ot)])])],2)}),256))])):(r(),v("div",nt,[p(n(q),{description:e.$t("suno.nodata")},null,8,["description"])]))}}),ut={key:0},dt={class:"w-full relative h-[300px]"},rt={class:"w-full h-full justify-center items-center flex"},pt={class:"absolute bottom-0 right-0 p-2 text-white text-right"},ct={class:"text-xl"},vt={class:""},mt={class:"text-wrap p-2"},ft={key:1,class:"flex w-full h-full justify-center items-center"},_t=z({__name:"mcplayer",setup(N){const o=$();return M(()=>g.myData.act,l=>{if(l=="goPlay"){let c=g.myData.actData;o.value=c}}),(l,c)=>o.value?(r(),v("div",ut,[t("div",dt,[p(n(R),{src:o.value.image_large_url,class:"w-full h-full"},{placeholder:y(()=>[t("div",rt,[p(n(k),{icon:"line-md:downloading-loop",class:"text-[60px] text-green-300"})])]),_:1},8,["src"]),t("div",pt,[t("h2",ct,d(o.value.title),1),t("div",vt,d(l.$t("suno.style"))+"："+d(o.value.metadata.tags),1)])]),t("pre",mt,d(o.value.metadata.prompt),1)])):(r(),v("div",ft,[p(n(q),{description:l.$t("suno.emputy")},null,8,["description"])]))}}),yt={class:"flex w-full h-full"},xt={class:"w-[300px] h-full overflow-y-auto"},ht={class:"flex-1 h-full bg-[#fafbfc] pt-2 dark:bg-[#18181c] overflow-y-auto"},gt={class:"w-[300px] h-full overflow-y-auto"},kt=z({__name:"music",setup(N){return(o,l)=>(r(),v("div",yt,[t("div",xt,[p(Pe)]),t("div",ht,[p(it)]),t("div",gt,[p(_t)])]))}});export{kt as default};
